{"ast":null,"code":"import React,{useState}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import'./Login.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=()=>{const[username,setUsername]=useState('');const[password,setPassword]=useState('');const[error,setError]=useState('');const navigate=useNavigate();const emailSuffix='@storelink.it';const[showSuggestions,setShowSuggestions]=useState(false);const handleEmailChange=e=>{const value=e.target.value;setUsername(value);// Show suggestions if no \"@\" is present\nsetShowSuggestions(!value.includes('@'));};const handleSuggestionClick=()=>{setUsername(prev=>`${prev}${emailSuffix}`);setShowSuggestions(false);};const handleSubmit=async e=>{e.preventDefault();setError('');try{const response=await axios.post('http://localhost:8000/token',new URLSearchParams({username:username,password:password}),{headers:{'Content-Type':'application/x-www-form-urlencoded'}});const{access_token,role,user_id}=response.data;localStorage.setItem('token',access_token);localStorage.setItem('user_id',user_id);// Redirect based on role\nif(role==='admin'){navigate('/admin-dashboard');}else{navigate('/employee-dashboard');}}catch(error){console.error('Error logging in:',error);setError('Login failed. Please check your credentials and try again.');}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter your email\",value:username,onChange:handleEmailChange}),showSuggestions&&/*#__PURE__*/_jsxs(\"div\",{style:{position:'absolute',backgroundColor:'white',border:'1px solid #ccc',borderRadius:'4px',width:'100%',zIndex:10,cursor:'pointer'},onClick:handleSuggestionClick,children:[username,\"@storelink.it\"]})]}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Password\",value:password,onChange:e=>setPassword(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Login\"})]}),error&&/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/register'),style:{marginTop:'10px'},children:\"Register\"})]});};export default Login;","map":{"version":3,"names":["React","useState","useNavigate","axios","jsx","_jsx","jsxs","_jsxs","Login","username","setUsername","password","setPassword","error","setError","navigate","emailSuffix","showSuggestions","setShowSuggestions","handleEmailChange","e","value","target","includes","handleSuggestionClick","prev","handleSubmit","preventDefault","response","post","URLSearchParams","headers","access_token","role","user_id","data","localStorage","setItem","console","children","onSubmit","style","position","type","placeholder","onChange","backgroundColor","border","borderRadius","width","zIndex","cursor","onClick","marginTop"],"sources":["/home/sl/PycharmProjects/presenza/frontend/presence-tracker/src/components/Login.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport './Login.css';\n \nconst Login = () => {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState('');\n  const navigate = useNavigate();\n  const emailSuffix = '@storelink.it';\n  const [showSuggestions, setShowSuggestions] = useState(false);\n\n  const handleEmailChange = (e) => {\n    const value = e.target.value;\n    setUsername(value);\n\n    // Show suggestions if no \"@\" is present\n    setShowSuggestions(!value.includes('@'));\n  };\n\n  const handleSuggestionClick = () => {\n    setUsername((prev) => `${prev}${emailSuffix}`);\n    setShowSuggestions(false);\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError('');\n    \n    try {\n      const response = await axios.post('http://localhost:8000/token', new URLSearchParams({\n        username: username,\n        password: password,\n      }), {\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' }\n      });\n\n      const { access_token, role, user_id} = response.data;\n      localStorage.setItem('token', access_token);\n      localStorage.setItem('user_id', user_id);\n      // Redirect based on role\n      if (role === 'admin') {\n        navigate('/admin-dashboard');\n      }\n      else {\n        navigate('/employee-dashboard');\n      }\n    } catch (error) {\n      console.error('Error logging in:', error);\n      setError('Login failed. Please check your credentials and try again.');\n    }\n  };\n\n  return (\n    <div>\n      <h2>Login</h2>\n      <form onSubmit={handleSubmit}>\n      <div style={{ position: 'relative' }}>\n          <input\n            type=\"text\"\n            placeholder=\"Enter your email\"\n            value={username}\n            onChange={handleEmailChange}\n          />\n          {showSuggestions && (\n            <div\n              style={{\n                position: 'absolute',\n                backgroundColor: 'white',\n                border: '1px solid #ccc',\n                borderRadius: '4px',\n                width: '100%',\n                zIndex: 10,\n                cursor: 'pointer',\n              }}\n              onClick={handleSuggestionClick}\n            >\n              {username}@storelink.it\n            </div>\n          )}\n        </div>\n        \n        <input\n          type=\"password\"\n          placeholder=\"Password\"\n          value={password}\n          onChange={(e) => setPassword(e.target.value)}\n        />\n        <button type=\"submit\">Login</button>\n      </form>\n      {error && <p>{error}</p>}\n\n      <button onClick={() => navigate('/register')} style={{ marginTop: '10px' }}>\n        Register\n      </button>\n    </div>\n\n  );\n};\n\nexport default Login;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}